<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, minimal-ui">
	<title>Mazemap JavaScript API example</title>

	<link rel="stylesheet" href="./mazemap.min.css">
	<script type='text/javascript' src='./mazemap.polyfilled.min.js'></script>


	<script>
		// the Maze namespace is an extension of the L namespace
		// Make a reference to enable compatibility with plugins that use the L namespace
		window.L = window.Maze;
	</script>

	<!-- The leaflet plugin. Get your own from https://github.com/Leaflet/Leaflet.heat -->
	<script src='./leaflet-heat.min.js'></script>

	<!-- Example data set -->
	<script src='./example-indoor-heatpoints-data.js'></script>
	<style>

		body {
			margin: 0;
		}

		#mazemap-container {
			width: 100vw;
			height: 100vh;
		}
	</style>

</head>
<body>


	<div id='mazemap-container'></div>

	<script>
	var map = Maze.map('mazemap-container', {
		campusloader: false,
		doubleClickZoom: false
	});

	Maze.Instancer.getCampus(1).then(function(campus){

		map.setView( {lat: 63.417668368136496, lng: 10.403929352760317}, 10);

		campus.addTo(map).setActive().then( function(c) {
			map.setZLevel(1);
		});

		var heatMap = Maze.heatLayer(indoorHeatPoints, {maxZoom: 22, max: 1, radius: 20, blur: 20}).addTo(map);

		map.on('click', function(e){
			//For this demo, you can click the map to add points dynamically
			heatMap.addLatLng(e.latlng);
		});
	});
	
    

	function getDistanceFromLatLonInMeters(lat1,lon1,lat2,lon2) {
		debugger;
	  var R = 6371; // Radius of the earth in km
	  var dLat = deg2rad(lat2-lat1);  // deg2rad below
	  var dLon = deg2rad(lon2-lon1); 
	  var a = 
	    Math.sin(dLat/2) * Math.sin(dLat/2) +
	    Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * 
	    Math.sin(dLon/2) * Math.sin(dLon/2)
	    ; 
	  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
	  var d = R * c; // Distance in km
	  return d/1000;
	}

	function deg2rad(deg) {
	  return deg * (Math.PI/180)
	}
	var distances = [5,15,20,30,2,4];
	

	function getLatLonFromDistance(lat1,lon1,distance){
		let lat2 = lat1;
		let lon2 = lon1;
		var diff = 0;
		var increase = 0.000000000000005;
		while(diff < distance){
			if (Math.random()>=0.5){
				lat2 +=increase;
			}else{
				lon2 +=increase;
			}
			diff = getDistanceFromLatLonInMeters(lat1,lon1,lat2,lon2);
		}		
		return {"lat": lat2,"lng":lon2}
	}


	</script>


</body>
</html>